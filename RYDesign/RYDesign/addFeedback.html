<!DOCTYPE html>
<html lang="en">
<head>
    <title>RY Design - Add feedback</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="Scripts/jquery-1.9.1.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
    <script src="Scripts/feedbackModule.js"></script>
    <link href="Content/style.css" rel="stylesheet" />
    <script src="Scripts/facebooklogin.js"></script>
    <script type="text/javascript">
      var appInsights=window.appInsights||function(config){
        function r(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},u=document,e=window,o="script",s=u.createElement(o),i,f;for(s.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",u.getElementsByTagName(o)[0].parentNode.appendChild(s),t.cookie=u.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)r("track"+i.pop());return r("setAuthenticatedUserContext"),r("clearAuthenticatedUserContext"),config.disableExceptionTracking||(i="onerror",r("_"+i),f=e[i],e[i]=function(config,r,u,e,o){var s=f&&f(config,r,u,e,o);return s!==!0&&t["_"+i](config,r,u,e,o),s}),t
        }({
            instrumentationKey:"1bf5af10-c841-4d28-aa2b-ef4cea5a3744"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
    </script>
    <link href="jQuery_Plugins/sweetalert.css" rel="stylesheet" />
</head>
<body>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="index.html"><img src="Images/logo.png" alt="RY Design Logo" /></a>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="specialsPage.html">Products</a></li>
                    <li><a href="contact.html">Contact us</a></li>
                    <li><a href="forumPage.html">Forum</a></li>
                    <li><a href="chatPage.html">Live Chat</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container" id="content">
        <div id="facebook_login">
            <fb:login-button scope="public_profile,email" onlogin="checkLoginState();"></fb:login-button>
            <div id="status"></div>
        </div>
        <div id="fbUserName" style="display: none;"></div>
        <div>
            <input type="button" id="goBackToFeedback" value="Go back to feedback" onclick="window.location.href='feedbackPage.html'" />
        </div>
        <div id="newForum">
            <div class="table-responsive">
                <!-- table will scroll across nicely when viewed on mobile-->
                <table class="table table-striped table-hover spaced-table">
                    <thead>
                        <!-- Table headings -->
                        <tr>
                            <th></th>
                            <!-- This is a table row-->
                            <th><h1>Add feedback</h1></th>
                        </tr>
                    </thead>
                    <tbody id="newForum">
                        <tr>
                            <td align="right" width="20%">Content of Feedback:</td>
                            <td width="80%"><textarea id="Content" style="resize: none;" cols="80" rows="10"></textarea></td>
                        </tr>
                        <tr>
                            <td align="right"><input type="button" id="createForum" value="Create" /></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="jQuery_Plugins/sweetalert.min.js"></script>
    <script>
        function n(n) {
            return n > 9 ? "" + n : "0" + n;
        }

        $("#createForum").click(function () {
            swal({
                title: "Create forum",
                text: "Are you sure you want to post a new feedback?",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#FF0000",
                confirmButtonText: "Yes",
                cancelButtonText: "No",
                closeOnConfirm: false
            }, function () {
                var feedbackContent = $.trim($("textarea").val());
                var personName = document.getElementById('fbUserName').innerHTML;
                if (feedbackContent == "") {
                    swal("Error", "Please fill in required information!", "error");
                }
                else if (!document.getElementById('fbUserName').innerHTML) {
                    alert("Please log into your facebook account!");
                }
                else {
                    var currentForum = feedbackModule.getCurrentForumID();
                    var date = new Date();
                    var currentDate = date.getFullYear() + "-" + (date.getMonth() + 1) + "-" + date.getDate() + "T" + n(date.getHours()) + ":" + n(date.getMinutes());
                    feedbackModule.postFeedback(currentForum, feedbackContent, personName, currentDate);
                    swal("Success", "You have successfully created a new feedback", "success");
                    document.getElementById("Content").value = "";
                    document.getElementById("Name").value = "";
                }
            });
        });
    </script>
    <div class="container">
        <footer><p>&copy; Copyright 2015 by RY Design, Inc. All rights reserved.</p></footer>
    </div>
</body>
</html>